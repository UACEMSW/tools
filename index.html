<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>EMS4 | Plan Control</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
    <style>
        .deploy-card { transition: all 0.2s ease; border-left: 5px solid #e2e8f0; }
        .plat-btn.active { border-color: #2563eb; background-color: #eff6ff; color: #2563eb; ring: 4px; ring-color: #eff6ff; }
        #loadingOverlay, #loginOverlay { background: rgba(255,255,255,0.95); position: fixed; inset: 0; z-index: 200; align-items: center; justify-content: center; display: flex; }
        #loadingOverlay { display: none; z-index: 210; }
        .viewer-mode .admin-only, .viewer-mode .super-only { display: none !important; }
        #saveBtn:disabled, #updateStatsBtn:disabled { background-color: #cbd5e1; cursor: not-allowed; opacity: 0.7; }
        /* Read-only styles for non-super users on stats */
        .readonly-stat { pointer-events: none !important; background-color: transparent; }
        .viewer-mode input:not(.prod-input), .viewer-mode select, .viewer-mode textarea { pointer-events: none !important; background-color: #f8fafc; }
    </style>
</head>
<body class="bg-slate-100 p-4 md:p-8 font-sans text-slate-900">

    <div id="loginOverlay" style="display: none;">
        <div class="bg-white p-8 rounded-3xl shadow-2xl border border-slate-200 w-full max-w-sm text-center">
            <h2 class="text-2xl font-black italic mb-6 text-blue-600 tracking-tighter uppercase">Access Control</h2>
            <input type="password" id="accessKey" placeholder="Enter Key..." class="w-full p-4 border-2 rounded-2xl mb-4 text-center font-bold outline-none">
            <button onclick="checkAccess()" class="w-full bg-blue-600 text-white p-4 rounded-2xl font-black uppercase hover:bg-blue-700 transition">Login</button>
        </div>
    </div>
    
    <div id="loadingOverlay"><div class="animate-spin rounded-full h-12 w-12 border-t-4 border-blue-600"></div></div>

    <div id="appContent" class="hidden max-w-5xl mx-auto">
        <header class="bg-white p-6 rounded-2xl shadow-sm border-b-4 border-blue-600 mb-4 flex flex-col md:flex-row justify-between items-center gap-4">
            
            <div class="flex items-center gap-3 w-full md:w-auto">
                <h1 class="text-2xl font-black italic uppercase tracking-tighter whitespace-nowrap">EMS4 PLAN</h1>
                <div id="prodContainer" class="hidden flex items-center bg-yellow-100 border border-yellow-200 px-3 py-1 rounded-lg">
                    <span class="text-[10px] font-black text-yellow-600 mr-2">PROD:</span>
                    <input type="text" id="prodType" oninput="compareData()" class="prod-input bg-transparent border-none outline-none font-black text-xs text-yellow-800 w-32 uppercase placeholder-yellow-400" placeholder="TYPE...">
                </div>
            </div>

            <div class="flex gap-4 items-center justify-end w-full md:w-auto">
                <div id="limitContainer" class="hidden bg-blue-50 px-4 py-2 rounded-xl border border-blue-100">
                    <label class="block text-[8px] font-black text-blue-400 uppercase tracking-widest text-center">Seeds/Hr</label>
                    <input type="number" id="globalLimit" oninput="compareData()" class="w-16 bg-transparent font-black text-blue-700 outline-none text-lg text-center" value="100">
                </div>
                <div class="text-right">
                    <div id="roleLabel" class="text-[9px] font-black text-slate-400 uppercase mb-1">---</div>
                    <span id="roleBadge" class="text-white px-2 py-0.5 rounded text-[8px] font-black uppercase">---</span>
                </div>
                <button onclick="logout()" class="admin-only text-[10px] text-red-500 font-bold underline">Logout</button>
            </div>
        </header>

        <div id="statsSection" class="hidden mb-6">
            <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
                <div class="bg-white p-3 rounded-2xl shadow-sm border border-slate-200">
                    <label class="block text-[9px] font-black text-slate-400 uppercase">Total Seeds</label>
                    <input type="text" id="statTotalSeeds" oninput="checkStatsChange()" class="stat-input w-full bg-transparent font-black text-blue-600 text-lg outline-none" value="0">
                </div>
                <div class="bg-white p-3 rounded-2xl shadow-sm border border-slate-200">
                    <label class="block text-[9px] font-black text-slate-400 uppercase">RDPs</label>
                    <input type="text" id="statRDPs" oninput="checkStatsChange()" class="stat-input w-full bg-transparent font-black text-slate-700 text-lg outline-none" value="0">
                </div>
                <div class="bg-white p-3 rounded-2xl shadow-sm border border-slate-200">
                    <label class="block text-[9px] font-black text-slate-400 uppercase">Sessions</label>
                    <input type="text" id="statSessions" oninput="checkStatsChange()" class="stat-input w-full bg-transparent font-black text-slate-700 text-lg outline-none" value="0">
                </div>
                <div class="bg-purple-50 p-3 rounded-2xl shadow-sm border border-purple-100 text-center">
                    <label class="block text-[9px] font-black text-purple-400 uppercase mb-1">Rotation (Min-Max)</label>
                    <div class="flex justify-center items-center gap-1 font-black text-purple-700">
                        <input type="number" id="rotMin" oninput="checkStatsChange()" class="stat-input w-10 bg-transparent text-center outline-none" value="0">
                        <span>-</span>
                        <input type="number" id="rotMax" oninput="checkStatsChange()" class="stat-input w-10 bg-transparent text-center outline-none" value="0">
                    </div>
                </div>
            </div>
            <button id="updateStatsBtn" disabled onclick="saveStatsOnly()" class="hidden mt-2 w-full bg-slate-800 text-white py-2 rounded-xl text-[10px] font-black uppercase tracking-widest transition">Update Stats Only (No Notify)</button>
        </div>

        <div class="platform-selector grid grid-cols-3 gap-4 mb-6">
            <button onclick="changePlat('WEB')" id="btn-WEB" class="plat-btn bg-white p-4 rounded-xl shadow-sm border-2 border-transparent font-black text-slate-600 uppercase italic">Web</button>
            <button onclick="changePlat('SELENIUM')" id="btn-SELENIUM" class="plat-btn bg-white p-4 rounded-xl shadow-sm border-2 border-transparent font-black text-slate-600 uppercase italic">Selenium</button>
            <button onclick="changePlat('AUTOMAT')" id="btn-AUTOMAT" class="plat-btn bg-white p-4 rounded-xl shadow-sm border-2 border-transparent font-black text-slate-600 uppercase italic">Automat</button>
        </div>

        <div id="mainSection" class="hidden space-y-6">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="bg-white p-5 rounded-2xl shadow-sm border border-slate-200">
                    <div class="flex justify-between items-center mb-2">
                        <h3 class="text-xs font-black text-red-500 uppercase italic">üö´ SPAM ACTIONS</h3>
                        <div class="flex items-center gap-2">
                            <div class="bg-red-500 text-white px-2 py-1 rounded text-[10px] font-black uppercase">TOTAL: <span id="spam-calculated-total">0</span></div>
                            <button onclick="showActionMenu('spam')" class="admin-only w-6 h-6 bg-red-500 text-white rounded-full font-bold">+</button>
                        </div>
                    </div>
                    <div id="spam-actions-container" class="grid grid-cols-2 gap-3"></div>
                </div>
                <div class="bg-white p-5 rounded-2xl shadow-sm border border-slate-200">
                    <div class="flex justify-between items-center mb-2">
                        <h3 class="text-xs font-black text-blue-500 uppercase italic">üì• INBOX ACTIONS</h3>
                        <div class="flex items-center gap-2">
                            <div class="bg-blue-600 text-white px-2 py-1 rounded text-[10px] font-black uppercase">TOTAL: <span id="inbox-calculated-total">0</span></div>
                            <button onclick="showActionMenu('inbox')" class="admin-only w-6 h-6 bg-blue-500 text-white rounded-full font-bold">+</button>
                        </div>
                    </div>
                    <div id="inbox-actions-container" class="grid grid-cols-2 gap-3"></div>
                </div>
            </div>

            <div class="bg-white p-6 rounded-2xl shadow-sm grid grid-cols-1 md:grid-cols-2 gap-6 border border-slate-200">
                <div>
                    <label class="block text-[10px] font-black text-slate-400 mb-1 uppercase tracking-widest text-center">Deploys Count</label>
                    <input type="number" id="deployCount" oninput="generateDeploys(); compareData();" class="admin-only w-full p-2 border-2 rounded-lg font-black text-blue-600 text-lg text-center">
                </div>
                <div>
                    <label class="block text-[10px] font-black text-blue-500 mb-1 uppercase italic">üîë Filter (Code Mot)</label>
                    <input type="text" id="filterKeyword" oninput="compareData()" class="admin-only w-full p-2 border-2 border-blue-100 rounded-lg font-bold text-blue-700 bg-blue-50">
                </div>
            </div>

            <div id="deploysContainer" class="space-y-4"></div>

            <div class="admin-only sticky bottom-4 z-10">
                <button id="saveBtn" disabled onclick="processSave()" class="w-full bg-blue-600 hover:bg-blue-700 text-white py-5 rounded-2xl font-black text-xl shadow-2xl uppercase italic">Save Plan & Notify</button>
            </div>
        </div>
    </div>

    <div id="actionModal" class="fixed inset-0 bg-black/50 hidden z-[300] flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl w-full max-w-xs overflow-hidden">
            <div class="bg-slate-900 p-4 text-white font-black uppercase text-xs text-center">Add Action</div>
            <div id="modalList" class="p-2 grid grid-cols-1 gap-1 max-h-64 overflow-y-auto"></div>
            <button onclick="closeModal()" class="w-full p-4 bg-slate-100 font-black uppercase text-[10px]">Cancel</button>
        </div>
    </div>

    <script>
        const ADMIN_KEY = "admin75"; 
        const SUPER_KEY = "super2025"; 
        const firebaseConfig = {
          apiKey: "AIzaSyAFR96bibEGLaMroqFZCLcSHyCoAdewz78",
          authDomain: "ems4-reporting.firebaseapp.com",
          databaseURL: "https://ems4-reporting-default-rtdb.firebaseio.com",
          projectId: "ems4-reporting"
        };
        
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
        const telegramToken = '8445418590:AAEzun8AqYrkmFnzMoXaz3UBIQRTQCgQHeI'; 
        const telegramChatId = '-5224398844';
        const netlifyBase = "https://ems4-plan.netlify.app";

        let userRole = "viewer"; 
        let currentPlatform = "";
        let oldCloudData = null;

        window.onload = function() {
            const savedKey = localStorage.getItem('ems4_key');
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.get('mode') === 'view') {
                userRole = "viewer"; document.body.classList.add('viewer-mode'); startApp();
                if(urlParams.get('plat')) selectPlatform(urlParams.get('plat'));
            } else if (savedKey === SUPER_KEY) {
                userRole = "super"; startApp();
            } else if (savedKey === ADMIN_KEY) {
                userRole = "admin"; startApp();
            } else { document.getElementById('loginOverlay').style.display = 'flex'; }
        };

        function checkAccess() {
            const input = document.getElementById('accessKey').value;
            if (input === SUPER_KEY || input === ADMIN_KEY) { localStorage.setItem('ems4_key', input); location.reload(); }
            else { alert("Access Denied!"); }
        }

        function logout() { localStorage.removeItem('ems4_key'); location.reload(); }

        function startApp() {
            document.getElementById('loginOverlay').style.display = 'none';
            document.getElementById('appContent').classList.remove('hidden');
            const badge = document.getElementById('roleBadge');
            const label = document.getElementById('roleLabel');
            
            if(userRole === 'super') {
                label.innerText = "ROLE: SUPER ADMIN"; badge.innerText = "SUPER"; badge.className = "bg-purple-600 text-white px-2 py-0.5 rounded text-[8px] font-black";
                document.getElementById('updateStatsBtn').classList.remove('hidden');
            } else {
                label.innerText = userRole === 'admin' ? "ROLE: ADMIN" : "ROLE: VIEWER"; 
                badge.innerText = userRole.toUpperCase(); badge.className = "bg-slate-600 text-white px-2 py-0.5 rounded text-[8px] font-black";
                // Lock stats for admins and viewers
                document.querySelectorAll('.stat-input').forEach(el => {
                    el.readOnly = true;
                    el.classList.add('readonly-stat');
                });
            }
        }

        async function selectPlatform(p) {
            currentPlatform = p;
            document.getElementById('loadingOverlay').style.display = 'flex';
            document.querySelectorAll('.plat-btn').forEach(b => b.classList.remove('active'));
            if(document.getElementById('btn-'+p)) document.getElementById('btn-'+p).classList.add('active');
            
            document.getElementById('mainSection').classList.remove('hidden');
            document.getElementById('statsSection').classList.remove('hidden');
            document.getElementById('limitContainer').classList.remove('hidden');
            document.getElementById('prodContainer').classList.remove('hidden');

            const snap = await db.ref(`ems4/plans/${p}/current`).once('value');
            oldCloudData = snap.val() || { limit: 100, prodType: "", filter: "", deploys: [], actions_list: [], stats: {seeds: '0', rdps: '0', sessions: '0', rotMin: 0, rotMax: 0} };

            document.getElementById('prodType').value = oldCloudData.prodType || "";
            document.getElementById('statTotalSeeds').value = oldCloudData.stats?.seeds || '0';
            document.getElementById('statRDPs').value = oldCloudData.stats?.rdps || '0';
            document.getElementById('statSessions').value = oldCloudData.stats?.sessions || '0';
            document.getElementById('rotMin').value = oldCloudData.stats?.rotMin || 0;
            document.getElementById('rotMax').value = oldCloudData.stats?.rotMax || 0;

            document.getElementById('spam-actions-container').innerHTML = '';
            document.getElementById('inbox-actions-container').innerHTML = '';
            document.getElementById('globalLimit').value = oldCloudData.limit || 100;
            document.getElementById('deployCount').value = oldCloudData.deploys ? oldCloudData.deploys.length : 8;
            document.getElementById('filterKeyword').value = oldCloudData.filter || "";
            
            if(oldCloudData.actions_list) oldCloudData.actions_list.forEach(a => addActionUI(a.type.toLowerCase(), a.name, a.value));
            
            generateDeploys(oldCloudData.deploys);
            calculateTotals();
            document.getElementById('saveBtn').disabled = true;
            document.getElementById('updateStatsBtn').disabled = true;
            document.getElementById('loadingOverlay').style.display = 'none';
        }

        function getChanges() {
            let diffs = [];
            const curLimit = parseInt(document.getElementById('globalLimit').value);
            const curFilter = document.getElementById('filterKeyword').value;
            const curProd = document.getElementById('prodType').value;
            
            if (curProd !== (oldCloudData.prodType || "")) diffs.push(`PROD: ${oldCloudData.prodType || 'None'} ‚ûú ${curProd}`);
            if (curLimit !== (oldCloudData.limit || 100)) diffs.push(`Limit: ${oldCloudData.limit || 100} ‚ûú ${curLimit}`);
            if (curFilter !== (oldCloudData.filter || "")) diffs.push(`Filter: ${curFilter || 'None'}`);

            const curActions = Array.from(document.querySelectorAll('.action-chip')).map(el => ({
                n: el.querySelector('label').innerText, v: parseInt(el.querySelector('input').value) || 0,
                t: el.closest('#spam-actions-container') ? 'SPAM' : 'INBOX'
            }));
            const oldActions = oldCloudData.actions_list || [];
            curActions.forEach(newA => {
                const oldA = oldActions.find(o => o.name === newA.n && o.type === newA.t);
                if(!oldA) diffs.push(`Added ${newA.n}`);
                else if (oldA.value !== newA.v) diffs.push(`${newA.n}: ${oldA.value} ‚ûú ${newA.v}`);
            });

            const deployCards = document.querySelectorAll('.deploy-card');
            deployCards.forEach((c, i) => {
                const oldD = oldCloudData.deploys?.[i] || {};
                const id = c.querySelector('.id-val').value.trim();
                if (id !== (oldD.id || "")) diffs.push(`Deploy ${i+1} ID Updated`);
            });
            return diffs;
        }

        function checkStatsChange() {
            if (!oldCloudData || userRole !== 'super') return;
            const s = oldCloudData.stats || {};
            const changed = document.getElementById('statTotalSeeds').value !== (s.seeds || '0') ||
                            document.getElementById('statRDPs').value !== (s.rdps || '0') ||
                            document.getElementById('statSessions').value !== (s.sessions || '0') ||
                            parseInt(document.getElementById('rotMin').value) !== (s.rotMin || 0) ||
                            parseInt(document.getElementById('rotMax').value) !== (s.rotMax || 0);
            document.getElementById('updateStatsBtn').disabled = !changed;
        }

        async function saveStatsOnly() {
            const stats = {
                seeds: document.getElementById('statTotalSeeds').value,
                rdps: document.getElementById('statRDPs').value,
                sessions: document.getElementById('statSessions').value,
                rotMin: parseInt(document.getElementById('rotMin').value),
                rotMax: parseInt(document.getElementById('rotMax').value)
            };
            document.getElementById('loadingOverlay').style.display = 'flex';
            await db.ref(`ems4/plans/${currentPlatform}/current/stats`).set(stats);
            oldCloudData.stats = stats;
            document.getElementById('updateStatsBtn').disabled = true;
            document.getElementById('loadingOverlay').style.display = 'none';
        }

        async function processSave() {
            const diffs = getChanges();
            if(diffs.length === 0) return;

            const limit = parseInt(document.getElementById('globalLimit').value);
            const filter = document.getElementById('filterKeyword').value;
            const prodType = document.getElementById('prodType').value;
            const actions = Array.from(document.querySelectorAll('.action-chip')).map(el => ({ 
                type: el.closest('#spam-actions-container') ? 'SPAM' : 'INBOX',
                name: el.querySelector('label').innerText, value: parseInt(el.querySelector('input').value) || 0
            }));
            const deploys = Array.from(document.querySelectorAll('.deploy-card')).map(c => ({
                from: c.querySelector('.from-val').value, id: c.querySelector('.id-val').value,
                batch: c.querySelector('.batch-val').value, rules: c.querySelector('.rules-val').value, ips: c.querySelector('.ips-val').value
            }));

            const saveObj = { ...oldCloudData, deploys, filter, limit, prodType, actions_list: actions, timestamp: new Date().toLocaleString() };
            document.getElementById('loadingOverlay').style.display = 'flex';
            await db.ref(`ems4/plans/${currentPlatform}/current`).set(saveObj);

            // Telegram Notification: Platform focused
            const telegramMsg = `üöÄ <b>PLAN UPDATED: ${currentPlatform}</b>\n` +
                                `‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n` +
                                `üìù <b>Changes:</b>\n${diffs.map(d => '‚Ä¢ ' + d).join('\n')}\n` +
                                `‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n` +
                                `üîó <a href="${netlifyBase}/?mode=view&plat=${currentPlatform}">VIEW MODIFICATIONS</a>`;

            await fetch(`https://api.telegram.org/bot${telegramToken}/sendMessage`, {
                method: 'POST', headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ chat_id: telegramChatId, text: telegramMsg, parse_mode: 'HTML', disable_web_page_preview: true })
            });

            location.reload();
        }

        // --- UI HELPERS ---
        function compareData() { if (oldCloudData) document.getElementById('saveBtn').disabled = (getChanges().length === 0); }
        function changePlat(p) { selectPlatform(p); }
        
        function generateDeploys(savedData = null) {
            const num = parseInt(document.getElementById('deployCount').value) || 0;
            const container = document.getElementById('deploysContainer');
            const currentInputs = Array.from(document.querySelectorAll('.deploy-card')).map(c => ({
                from: c.querySelector('.from-val').value, id: c.querySelector('.id-val').value,
                batch: c.querySelector('.batch-val').value, rules: c.querySelector('.rules-val').value, ips: c.querySelector('.ips-val').value
            }));
            container.innerHTML = "";
            for (let i = 0; i < num; i++) {
                const d = (savedData && savedData[i]) ? savedData[i] : (currentInputs[i] || { from: '', id: '', batch: '10/3000P', rules: 'SELECT ALL IPS', ips: '' });
                container.innerHTML += `
                    <div class="deploy-card bg-white p-4 rounded-2xl shadow-sm border border-slate-200">
                        <div class="text-[10px] font-black mb-2 uppercase text-slate-400">Deploy ${i+1}</div>
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-2 mb-2">
                            <input type="text" oninput="compareData()" class="from-val p-2 border rounded text-xs" value="${d.from}" placeholder="FROM">
                            <input type="text" oninput="compareData()" class="id-val p-2 border rounded text-xs font-black text-blue-600" value="${d.id}" placeholder="ID">
                            <select onchange="compareData()" class="batch-val p-2 border rounded text-xs">
                                <option ${d.batch == '0/0 Parallel' ? 'selected' : ''}>0/0 Parallel</option>
                                <option ${d.batch == '3/3000P' ? 'selected' : ''}>3/3000P</option>
                                <option ${d.batch == '5/3000P' ? 'selected' : ''}>5/3000P</option>
                                <option ${d.batch == '10/3000P' ? 'selected' : ''}>10/3000P</option>
                            </select>
                            <select onchange="compareData()" class="rules-val p-2 border rounded text-xs">
                                <option>SELECT ALL IPS</option>
                                <option ${d.rules == 'SELECT 30 IPS MAX' ? 'selected' : ''}>SELECT 30 IPS MAX</option>
                                <option ${d.rules == 'RANDOM ON SELECTED' ? 'selected' : ''}>RANDOM ON SELECTED</option>
                                <option ${d.rules == 'RANDOM ON SERVER SELECTED' ? 'selected' : ''}>RANDOM ON SERVER SELECTED</option>
                                <option ${d.rules == '2 ips RANDOM ON SERVER SELECTED' ? 'selected' : ''}>2 ips RANDOM ON SERVER SELECTED</option>
                            </select>
                        </div>
                        <textarea oninput="compareData()" class="ips-val w-full p-2 border rounded text-[10px] font-mono bg-slate-50" rows="1">${d.ips}</textarea>
                    </div>`;
            }
        }

        function addActionUI(type, name, value) {
            const container = document.getElementById(`${type}-actions-container`);
            if ([...container.querySelectorAll('label')].some(l => l.innerText === name)) return;
            const div = document.createElement('div');
            const color = type === 'spam' ? 'red' : 'blue';
            div.className = `bg-${color}-50 border-${color}-100 p-2 rounded-xl border relative action-chip`;
            div.innerHTML = `
                ${userRole !== 'viewer' ? `<button onclick="this.parentElement.remove(); calculateTotals(); compareData();" class="absolute -top-1 -right-1 bg-red-500 text-white rounded-full w-4 h-4 text-[10px]">√ó</button>` : ''}
                <label class="block text-[8px] font-black text-${color}-400 uppercase">${name}</label>
                <input type="number" oninput="calculateTotals(); compareData()" class="w-full bg-transparent font-black text-${color}-700 text-lg outline-none" value="${value}">
            `;
            container.appendChild(div);
            calculateTotals();
        }

        function calculateTotals() {
            ['spam', 'inbox'].forEach(type => {
                let sum = 0;
                document.querySelectorAll(`#${type}-actions-container input`).forEach(inp => { sum += parseInt(inp.value) || 0; });
                document.getElementById(`${type}-calculated-total`).innerText = sum;
            });
        }

        function showActionMenu(type) {
            const list = document.getElementById('modalList'); list.innerHTML = "";
            const opts = type === 'spam' ? ["NOT SPAM", "REPLY", "CLICK", "MOVE"] : ["READ", "ARCHIVE", "STAR"];
            opts.forEach(o => {
                const b = document.createElement('button');
                b.className = "p-3 text-left hover:bg-slate-100 uppercase text-[10px] font-bold";
                b.innerText = o; b.onclick = () => { addActionUI(type, o, 0); closeModal(); compareData(); };
                list.appendChild(b);
            });
            document.getElementById('actionModal').classList.remove('hidden');
        }
        function closeModal() { document.getElementById('actionModal').classList.add('hidden'); }
    </script>
</body>
</html>
